# Excel VBAコード作成プロンプトの例

## 例1: データ転記処理

```
以下の要件でVBAコードを作成してください：

目的：
シートA（データ元）からシートB（転記先）に特定の条件で値を転記

要件：
1. データ元シート名：[Sales_Data]
2. 転記先シート名：[Summary]
3. 転記ルール：
   - 条件：A列の値が"完了"のみ
   - 転記項目：
     - B列→転記先B列（商品名）
     - D列→転記先C列（金額）
     - F列→転記先D列（担当者）
4. 書式設定：
   - 金額列は"#,##0"形式
   - 文字列は中央揃え

エラー処理：
- シート不在時の処理
- データ不正時の処理

出力形式：
- メインプロシージャとサブプロシージャの分離
- 処理段階のステータス表示
```

## 例2: 条件付きフォーマット自動化

```
以下の仕様のVBAコードを作成してください：

目的：
売上データに対して条件付き書式を自動適用

対象シート：
- シート名：[Monthly_Sales]
- 範囲：A1:F100

書式設定要件：
1. 数値条件：
   - E列（売上）が前月比110%以上：緑背景
   - E列（売上）が前月比90%未満：赤背景
2. テキスト条件：
   - C列（状態）が"キャンセル"：グレー文字
   - C列（状態）が"完了"：青文字

実行タイミング：
- シートの更新時
- ユーザーによる手動実行

必要な機能：
- 既存の条件付き書式をクリア
- 処理範囲の動的決定
- 処理結果の通知
```

## 例3: データ検証とクリーニング

```
以下の仕様でVBAプログラムを作成してください：

目的：
入力データの検証とクリーニング処理

対象データ：
- シート：[Customer_Data]
- 列：
  A: 顧客ID（必須、数値）
  B: 顧客名（必須、文字列）
  C: 電話番号（任意、書式：XX-XXXX-XXXX）
  D: メール（任意、@を含む）
  E: 登録日（必須、日付）

要件：
1. データ検証：
   - 必須項目の空欄チェック
   - 形式チェック（数値、日付、電話番号形式）
   - 重複チェック（顧客ID）

2. データクリーニング：
   - 前後の空白除去
   - 全角数字の半角変換
   - 日付形式の統一

3. エラー処理：
   - エラー箇所の色付けハイライト
   - エラーログの作成（別シート）

出力要件：
- 処理結果のサマリーレポート
- エラー内容の詳細リスト
```

## 例4: レポート自動生成

```
以下の仕様でVBAコードを開発してください：

目的：
月次売上レポートの自動生成

入力データ：
- シート名：[Raw_Sales_Data]
- 構造：
  A: 日付
  B: 商品区分
  C: 商品名
  D: 数量
  E: 単価
  F: 売上

出力要件：
1. 集計テーブル：
   - 商品区分別の売上合計
   - 週別の売上推移
   - TOP10商品リスト

2. グラフ作成：
   - 商品区分別売上（円グラフ）
   - 日次売上推移（折れ線）
   - 累計売上（棒グラフ+折れ線）

3. レイアウト：
   - A4サイズに収まるように調整
   - 印刷設定の自動化
   - ヘッダー/フッター設定

オプション機能：
- PDFエクスポート
- 前月比較データの追加
- コメント自動生成
```

各プロンプトの共通要素：

1. 明確な目的の記述
2. 具体的な入出力要件
3. 処理ルールの詳細
4. エラー処理の指定
5. 期待される出力形式

作成するVBAコードの性質に応じて、これらのテンプレートを基に必要な要素を追加/削除してカスタマイズすることができます。プロンプトに含める要素について、追加や修正が必要な点はありますでしょうか？