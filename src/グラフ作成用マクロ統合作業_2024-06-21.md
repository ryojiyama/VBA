```vb
Sub CustomizeSheetFormats()
    Dim sheetNames As Variant
    Dim ws As Worksheet
    Dim cell As Range
    Dim rng As Range

    ' Apply to the following sheets
    sheetNames = Array("LOG_Helmet", "LOG_FallArrest", "LOG_Bicycle", "LOG_BaseBall")

    ' Loop through each sheet
    For Each sheet In sheetNames
        Set ws = Worksheets(sheet)

        ' Loop through each cell in the first row
        For Each cell In ws.Rows(1).Cells
            If InStr(1, cell.value, "ID") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "試料ID") > 0 Then ' String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "品番") > 0 Then ' String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "試験内容") > 0 Then ' String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "検査日") > 0 Then ' Date
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToDate(rng)
            ElseIf InStr(1, cell.value, "温度") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumeric(rng)
            ElseIf InStr(1, cell.value, "最大値(kN)") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumericFourDecimals(rng)
            ElseIf InStr(1, cell.value, "最大値の時間(ms)") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumericTwoDecimals(rng)
            ElseIf InStr(1, cell.value, "4.9kN") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumericTwoDecimals(rng)
            ElseIf InStr(1, cell.value, "7.3kN") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumericTwoDecimals(rng)
            ElseIf InStr(1, cell.value, "前処理") > 0 Then ' String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "重量") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumeric(rng)
            ElseIf InStr(1, cell.value, "天頂すきま") > 0 Then ' Numeric
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToNumeric(rng)
            ElseIf InStr(1, cell.value, "製品ロット") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "帽体ロット") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "内装ロット") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "構造検査") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "耐貫通検査") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            ElseIf InStr(1, cell.value, "試験区分") > 0 Then 'String
                Set rng = ws.Range(cell, ws.Cells(Rows.Count, cell.Column).End(xlUp))
                Call ConvertToString(rng)
            End If
        Next cell
    Next sheet
End Sub

Sub ConvertToNumeric(rng As Range)
    Dim cell As Range
    rng.NumberFormat = "0.0"
    For Each cell In rng
        If IsNumeric(cell.Value) Then
            cell.Value = CDbl(cell.Value)
        Else
            cell.ClearContents
        End If
    Next cell
End Sub

Sub ConvertToNumericTwoDecimals(rng As Range)
    Dim cell As Range
    rng.NumberFormat = "0.00"
    For Each cell In rng
        If IsNumeric(cell.Value) Then
            cell.Value = CDbl(cell.Value)
        Else
            cell.ClearContents
        End If
    Next cell
End Sub

Sub ConvertToNumericFourDecimals(rng As Range)
    Dim cell As Range
    rng.NumberFormat = "0.0000"
    For Each cell In rng
        If IsNumeric(cell.Value) Then
            cell.Value = CDbl(cell.Value)
        Else
            cell.ClearContents
        End If
    Next cell
End Sub

Sub ConvertToString(rng As Range)
    Dim cell As Range
    rng.NumberFormat = "@"
    For Each cell In rng
        cell.Value = CStr(cell.Value)
    Next cell
End Sub

Sub ConvertToDate(rng As Range)
    Dim cell As Range
    rng.NumberFormat = "yyyy/mm/dd"  ' 日付の表示形式を設定
    For Each cell In rng
        If IsDate(cell.Value) Then
            cell.Value = CDate(cell.Value)
        Else
            cell.ClearContents
        End If
    Next cell
End Sub


' B列にIDを作成する。
Sub TransformIDs()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim cellValue As String
    Dim newID As String

    ' LOG_Helmetシートを設定
    Set ws = ThisWorkbook.Sheets("LOG_Helmet")

    ' 最終行を取得
    lastRow = ws.Cells(ws.Rows.Count, "C").End(xlUp).row

    ' 2行目から最終行までループ（1行目はヘッダーと仮定）
    For i = 2 To lastRow
        cellValue = ws.Cells(i, "C").value

        ' IDを変換
        newID = GenerateNewID(cellValue)

        ' 新しいIDをセルにセット
        ws.Cells(i, "B").value = newID
    Next i
End Sub

Function GenerateNewID(cellValue As String) As String
    'TransformIDsのサブプロシージャ
    Dim numPart As String
    Dim otherPart As String
    Dim newID As String
    Dim matches As Object
    Dim reNum As Object
    Dim reOther As Object
    Dim startIndex As Long

    ' 数値部分の正規表現オブジェクトを作成
    Set reNum = CreateObject("VBScript.RegExp")
    reNum.Global = False
    reNum.IgnoreCase = False
    reNum.Pattern = "d{3,5}F?"

    ' 数値部分を抽出
    If reNum.Test(cellValue) Then
        Set matches = reNum.Execute(cellValue)
        numPart = ExtractNumberPart(matches(0).value)
        newID = numPart

        ' 特定の文字列に続く部分を抽出
        otherPart = ExtractOtherPart(cellValue, reNum.Execute(cellValue)(0).FirstIndex + 1)

        ' デバッグ用の出力
        Debug.Print numPart
        Debug.Print otherPart

        ' 新しいIDを結合
        GenerateNewID = newID & otherPart
    Else
        ' 数値部分が見つからない場合は元の値を返す
        GenerateNewID = cellValue
    End If
End Function

Function ExtractNumberPart(numPart As String) As String
        'TransformIDsのサブプロシージャ
    Dim hasF As Boolean
    ' 数字部分の末尾がFの場合
    hasF = Right(numPart, 1) = "F"
    If hasF Then
        ' 末尾のFを除去して数値部分を取得
        numPart = Left(numPart, Len(numPart) - 1)
        ' 新しいIDを生成（前後にFを追加）
        ExtractNumberPart = "F" & numPart & "F"
    Else
        ' 末尾にFがない場合はそのまま使用
        ExtractNumberPart = numPart
    End If
End Function

Function ExtractOtherPart(cellValue As String, startIndex As Long) As String
    'TransformIDsのサブプロシージャ
    Dim reOther As Object
    Dim matches As Object
    Dim otherPart As String
    Dim endIndex As Long

    ' 特定の文字列に続く部分を抽出するための正規表現
    Set reOther = CreateObject("VBScript.RegExp")
    reOther.Global = False
    reOther.IgnoreCase = False
    reOther.Pattern = "-(天|前|後|側)"

    If reOther.Test(cellValue) Then
        startIndex = reOther.Execute(cellValue)(0).FirstIndex + 1
        otherPart = Mid(cellValue, startIndex)

        ' 最後の'-'以降の文字を取り除く
        endIndex = InStrRev(otherPart, "-")
        If endIndex > 0 Then
            otherPart = Left(otherPart, endIndex - 1)
        End If
        ExtractOtherPart = otherPart
    Else
        ExtractOtherPart = ""
    End If
End Function

セルに同値が見つかった場合、それが同値ではなくなるように修正したい。試験結果に影響がない小数点第4~5位で値を調整する。
23.45980 の場合 80の部分の8の部分は 5~9, 0の部分は 1~9 とランダムに変化させ、同値ではなくす。
このアプローチを日本語で説明してください。

Excelのシートを他のブックにコピーしたい。コピーするシート名は"LOG_Helmet", "LOG_FallArrest", "LOG_Bicycle", "LOG_Baseball"
それぞれのシートのB2を捜索し、値が入っていないシートは処理をスキップ。
コピーするときシート名の最後に,"-1"のように連番をつけてください。
コピー先のブックはこれを実行するブックと同じディレクトリ内にある"Helmet", "FallArrest", "Bicycle", "BaseBall" フォルダの中にあるすべてのファイルです。
コピー元のシート名とフォルダ名は合わせてください。ex:LOG_Helmet -> Helmetフォルダ
